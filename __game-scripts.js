var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){var t=this,onWindowResize=function(){t._checkAspectRatio()};window.addEventListener("resize",onWindowResize,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var i=this.entity.getRotation();if(this._yaw=this._calcYaw(i),this._pitch=this._clampPitchAngle(this._calcPitch(i,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var e=new pc.Vec3;e.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(e.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:distanceMax",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:pitchAngleMin",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:pitchAngleMax",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:focusEntity",(function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)})),this.on("attr:frameOnStart",(function(t,i){t&&this.focus(this.focusEntity||this.app.root)})),this.on("destroy",(function(){window.removeEventListener("resize",onWindowResize,!1)})),this.distance=30},OrbitCamera.prototype.update=function(t){var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t,i){var e=0;if(t.model){var a=t.model.meshInstances;for(e=0;e<a.length;e++)0===i?this._modelsAabb.copy(a[e].aabb):this._modelsAabb.add(a[e].aabb),i+=1}for(e=0;e<t.children.length;++e)i+=this._buildAabb(t.children[e],i);return i},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,onMouseOut=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",onMouseOut,!1),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",onMouseOut,!1)}))}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,i=MouseInput.toWorldPoint,e=MouseInput.worldDiff,s=this.entity.camera,n=this.orbitCamera.distance;let p;s.screenToWorld(t.x,t.y,n,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,n,i),e.sub2(i,o),p=(e.y,e.z,new pc.Vec3(e.x,0,e.z)),this.orbitCamera.pivotPoint.add(p);let u=pc.math.clamp(this.orbitCamera.pivotPoint.x,-this.entity.script.customInput.BoundingBox.getLocalScale().x/2,this.entity.script.customInput.BoundingBox.getLocalScale().x/2),a=pc.math.clamp(this.orbitCamera.pivotPoint.z,-this.entity.script.customInput.BoundingBox.getLocalScale().z/2,this.entity.script.customInput.BoundingBox.getLocalScale().z/2);this.orbitCamera.pivotPoint=new pc.Vec3(u,this.orbitCamera.pivotPoint.y,a)},MouseInput.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.entity.script.customInput.panOnly?this.panButtonDown=!0:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:}},MouseInput.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.panButtonDown=!1,this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:}},MouseInput.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInput.prototype.onMouseWheel=function(t){this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),PreviousPosition=this.orbitCamera.distance,t.event.preventDefault()},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInput.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",(function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)})))},TouchInput.prototype.getPinchDistance=function(t,i){console.log(i);var o=t.x-i.x,n=t.y-i.y;return Math.sqrt(o*o+n*n)},TouchInput.prototype.calcMidPoint=function(t,i,o){o.set(i.x-t.x,i.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y},TouchInput.prototype.onTouchStartEndCancel=function(t){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))},TouchInput.fromWorldPoint=new pc.Vec3,TouchInput.toWorldPoint=new pc.Vec3,TouchInput.worldDiff=new pc.Vec3,TouchInput.prototype.pan=function(t){var i=TouchInput.fromWorldPoint,o=TouchInput.toWorldPoint,n=TouchInput.worldDiff,c=this.entity.camera,s=this.orbitCamera.distance;let h;c.screenToWorld(t.x,t.y,s,i),c.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,s,o),n.sub2(o,i),h=(n.y,n.z,new pc.Vec3(n.x,0,n.z)),this.orbitCamera.pivotPoint.add(h);let e=pc.math.clamp(this.orbitCamera.pivotPoint.x,-this.entity.script.customInput.BoundingBox.getLocalScale().x/2,this.entity.script.customInput.BoundingBox.getLocalScale().x/2),a=pc.math.clamp(this.orbitCamera.pivotPoint.z,-this.entity.script.customInput.BoundingBox.getLocalScale().z/2,this.entity.script.customInput.BoundingBox.getLocalScale().z/2);this.orbitCamera.pivotPoint=new pc.Vec3(e,this.orbitCamera.pivotPoint.y,a)},TouchInput.pinchMidPoint=new pc.Vec2,TouchInput.prototype.onTouchMove=function(t){var i=TouchInput.pinchMidPoint,o=t.touches;if(console.log(o[1]),this.entity.script.customInput.panOnly){var n=this.getPinchDistance(o[0],o[1]),c=n-this.lastPinchDistance;this.lastPinchDistance=n,this.orbitCamera.distance-=c*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),PreviousPosition=this.orbitCamera.distance,this.calcMidPoint(o[0],o[1],i),this.pan(i),this.lastPinchMidPoint.copy(i)}else if(1==o.length){var s=o[0];this.orbitCamera.pitch-=(s.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(s.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(s.x,s.y)}};var KeyboardInput=pc.createScript("keyboardInput");KeyboardInput.attributes.add("DummyUI",{type:"entity",array:!0}),KeyboardInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera},KeyboardInput.prototype.postInitialize=function(){this.orbitCamera&&(this.startDistance=this.orbitCamera.distance,this.startYaw=this.orbitCamera.yaw,this.startPitch=this.orbitCamera.pitch,this.startPivotPosition=this.orbitCamera.pivotPoint.clone())},KeyboardInput.prototype.update=function(t){this.orbitCamera&&this.app.keyboard.wasPressed(pc.KEY_2)};var CameraAnimations=pc.createScript("cameraAnimations");CameraAnimations.attributes.add("Building1",{type:"entity"}),CameraAnimations.attributes.add("Building2",{type:"entity"}),CameraAnimations.attributes.add("Building3",{type:"entity"}),CameraAnimations.attributes.add("Building4",{type:"entity"}),CameraAnimations.attributes.add("CubeMaps",{type:"asset",array:!0}),CameraAnimations.attributes.add("SceneBtn",{type:"entity",array:!0}),CameraAnimations.attributes.add("BuildingBtns",{type:"entity",array:!0}),CameraAnimations.attributes.add("BackBtn",{type:"entity"}),CameraAnimations.attributes.add("Scene",{type:"string",array:!0});var positionSet,lastCamPositionNew,allowHotspot=!0,orbitRotation=!0,animateCam=!1,timeAlpha=0,yawAngle=0,pitchAngle=0,newYawValue=0,newPitchValue=0,difference=0,diff2=0,showTag="",hidingTag="",divValue=0,calc=0,remainder=0,animatePointCheck=1,FirstPosition=29.5,PreviousPosition=0,clickFirstTIME=!1;CameraAnimations.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastCamPosition=new pc.Vec2,this.lastPivotPoint=new pc.Vec3,this.app.on("ui:SetFocus",(function(e,t){this.AnimateFocus(e,t)}),this);var e=this;this.scene0=this.app.scenes.find(this.Scene[0]),this.scene1=this.app.scenes.find(this.Scene[1]),this.scene2=this.app.scenes.find(this.Scene[2]),this.SceneBtn[0].element.on("click",(function(t){this.BackBtn.enabled=!1,allowHotspot=!1,e.app.scenes.loadSceneData(e.scene0,(function(e,t){e&&console.error(e)}));var i=e.Scene[0],a=e.app.scenes.find(e.Scene[0]).url;console.log(i,a),setTimeout(function(){e.loadScene(e.scene0)}.bind(e),10)}),this),this.SceneBtn[1].element.on("click",(function(t){this.BackBtn.enabled=!1,allowHotspot=!1,e.app.scenes.loadSceneData(e.scene1,(function(e,t){e&&console.error(e)}));var i=e.Scene[0],a=e.app.scenes.find(e.Scene[1]).url;console.log(i,a),setTimeout(function(){e.loadScene(e.scene1)}.bind(this),10)}),this),this.SceneBtn[2].element.on("click",(function(t){this.BackBtn.enabled=!1,allowHotspot=!1,e.app.scenes.loadSceneData(e.scene2,(function(e,t){e&&console.error(e)}));var i=e.Scene[0],a=e.app.scenes.find(e.Scene[2]).url;console.log(i,a),setTimeout(function(){e.loadScene(e.scene2)}.bind(this),10)}),this),this.BackBtn.element.on("click",(function(e){this.BackBtn.enabled=!1,clickFirstTIME=!0;for(let e=0;e<this.BuildingBtns.length;e++)this.BuildingBtns[e].enabled=!0;this.entity.script.customInput.panOnly=!0,this.entity.script.customInput.orBitOnly=!1,positionSet=0!=PreviousPosition&&1==clickFirstTIME?PreviousPosition:FirstPosition,this.AnimateZoom(positionSet),this.AnimateCameraBack()}),this)},CameraAnimations.prototype.changeScene=function(e){},CameraAnimations.prototype.update=function(e){if(this.orbitCamera,animateCam&&(timeAlpha+=1/540,yawAngle=pc.math.lerp(this.orbitCamera.yaw,newYawValue,timeAlpha),pitchAngle=pc.math.lerp(this.orbitCamera.pitch,newPitchValue,timeAlpha),clickFirstTIME=!0,this.orbitCamera.yaw=yawAngle,this.orbitCamera.pitch=pitchAngle,difference=this.orbitCamera.yaw-newYawValue,diff2=this.orbitCamera.pitch-newPitchValue,difference>-1&&difference<1&&diff2>-1)){animateCam=!1;var t=this;if(1==animatePointCheck){for(let e=0;e<this.SceneBtn.length;e++)t.SceneBtn[e].enabled=!1;this.BackBtn.enabled=!0;for(let e=0;e<this.BuildingBtns.length;e++)this.BuildingBtns[e].enabled=!1;t.SceneBtn[0].enabled=!0,t.entity.script.customInput.panOnly=!1,t.entity.script.customInput.orBitOnly=!0}else if(2==animatePointCheck){for(let e=0;e<this.SceneBtn.length;e++)t.SceneBtn[e].enabled=!1;this.BackBtn.enabled=!0;for(let e=0;e<this.BuildingBtns.length;e++)this.BuildingBtns[e].enabled=!1;t.SceneBtn[1].enabled=!0,t.entity.script.customInput.panOnly=!1,t.entity.script.customInput.orBitOnly=!0}else if(3==animatePointCheck){for(let e=0;e<this.SceneBtn.length;e++)t.SceneBtn[e].enabled=!1;for(let e=0;e<this.BuildingBtns.length;e++)this.BuildingBtns[e].enabled=!1;this.BackBtn.enabled=!0,t.SceneBtn[2].enabled=!0,t.entity.script.customInput.panOnly=!1,t.entity.script.customInput.orBitOnly=!0}else{for(let e=0;e<this.SceneBtn.length;e++)t.SceneBtn[e].enabled=!1;for(let e=0;e<this.BuildingBtns.length;e++)this.BuildingBtns[e].enabled=!0;t.entity.script.customInput.panOnly=!0,t.entity.script.customInput.orBitOnly=!1}}},CameraAnimations.prototype.AnimateFocus=function(e,t){console.log(this.orbitCamera.yaw+" :yaw"),console.log(this.orbitCamera.pitch+" :pitch"),(lastCamPositionNew=this.lastCamPosition).x=45,lastCamPositionNew.y=-31,this.lastPivotPoint=this.orbitCamera.pivotPoint.clone();for(let e=0;e<this.SceneBtn.length;e++)this.SceneBtn[e].enabled=!1;("1"==e||"2"==e||"3"==e||"4"==e)&&(this.AnimateCamera(e),this.AnimateZoom(15)),this.AnimatePivot(t),animatePointCheck=e},CameraAnimations.prototype.AnimateCameraBack=function(e){remainder=0,timeAlpha=0,remainder=this.orbitCamera.yaw%360,remainder=this.orbitCamera.yaw<0?remainder<-180+lastCamPositionNew.x?0:1:remainder>180-lastCamPositionNew.x?1:0,animateCam=!0,newYawValue=lastCamPositionNew.x,divValue=Math.floor(this.orbitCamera.yaw/360)+remainder,newYawValue+=calc=360*divValue,newPitchValue=lastCamPositionNew.y,animatePointCheck="none",this.AnimatePivot(this.lastPivotPoint)},CameraAnimations.prototype.AnimateCamera=function(e){remainder=0,timeAlpha=0,remainder=this.orbitCamera.yaw%360,"1"==e&&(remainder=this.orbitCamera.yaw%360,remainder=this.orbitCamera.yaw<0?remainder<-180?0:1:remainder>180?1:0,animateCam=!0,newYawValue=-0,divValue=Math.floor(this.orbitCamera.yaw/360)+remainder,newYawValue+=calc=360*divValue,newPitchValue=-30),"3"==e&&(remainder=this.orbitCamera.yaw%360,remainder=this.orbitCamera.yaw<0?remainder<-270?0:1:remainder>90?1:0,console.log(remainder),animateCam=!0,newYawValue=-90,divValue=Math.floor(this.orbitCamera.yaw/360)+remainder,newYawValue+=calc=360*divValue,newPitchValue=-20),"2"==e&&(remainder=this.orbitCamera.yaw%360,remainder=this.orbitCamera.yaw<0?remainder<-225?0:1:remainder>135?1:0,animateCam=!0,newYawValue=-45,divValue=Math.floor(this.orbitCamera.yaw/360)+remainder,newYawValue+=calc=360*divValue,newPitchValue=-15),"4"==e&&(remainder=this.orbitCamera.yaw%360,remainder=this.orbitCamera.yaw<0?remainder<-135?0:1:remainder>225?1:0,animateCam=!0,newYawValue=45,divValue=Math.floor(this.orbitCamera.yaw/360)+remainder,newYawValue+=calc=360*divValue,newPitchValue=-5),"5"==e&&(remainder=this.orbitCamera.yaw%360,remainder=this.orbitCamera.yaw<0?remainder<-315?0:1:remainder>45?1:0,animateCam=!0,newYawValue=-135,divValue=Math.floor(this.orbitCamera.yaw/360)+remainder,newYawValue+=calc=360*divValue,newPitchValue=-50)},CameraAnimations.prototype.AnimatePivot=function(e){var t=this;from=t.orbitCamera.pivotPoint,console.log(t.orbitCamera.pivotPoint+" pivot start"),console.log(from+" from"),console.log(e+" to");const i=from;t.entity.tween(i).to(e,1,pc.Linear).loop(!1).yoyo(!1).on("update",(function(){t.orbitCamera.pivotPoint=new pc.Vec3(i.x,t.orbitCamera.pivotPoint.y,i.z)})).start()},CameraAnimations.prototype.MoveEntity=function(e,t){},CameraAnimations.prototype.AnimateZoom=function(e){let t=this;from=t.orbitCamera.distance;let i={state:from};t.entity.tween(i).to({state:e},1,pc.Linear).loop(!1).yoyo(!1).on("update",(function(){t.orbitCamera.distance=i.state,console.log(i.state)})).start()},CameraAnimations.prototype.loadScene=function(e){var t=this.app.root.findByName("Root"),i=this;i.app.scenes.loadSceneHierarchy(e,(function(a,n){a?console.error(a):i.app.scenes.loadSceneSettings(e,(function(e,i){e?console.error(e):t.destroy()}))}))};pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.EASE_LINEAR,this._sv={},this._ev={}};Tween.prototype={to:function(t,i,e,s,n,r){return t instanceof pc.Vec3?this._properties={x:t.x,y:t.y,z:t.z}:t instanceof pc.Color?(this._properties={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(this._properties.a=t.a)):this._properties=t,this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this},from:function(t,i,e,s,n,r){return t instanceof pc.Vec3?this._properties={x:t.x,y:t.y,z:t.z}:t instanceof pc.Color?(this._properties={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(this._properties.a=t.a)):this._properties=t,this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,s,n,r){return t instanceof pc.Quat?this._properties={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Vec3?this._properties={x:t.x,y:t.y,z:t.z}:t instanceof pc.Color?(this._properties={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(this._properties.a=t.a)):this._properties=t,this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._slerp=!0,this},start:function(){if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(var t in this._properties)this._sv[t]=this._properties[t],this._ev[t]=this.target[t];if(this._slerp){this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z);var i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z;this._fromQuat.setFromEulerAngles(i,e,s)}}else{for(var t in this._properties)this._sv[t]=this.target[t],this._ev[t]=this._properties[t];if(this._slerp){this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z);i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z;this._toQuat.setFromEulerAngles(i,e,s)}}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,s,n=this.time/this.duration,r=this.easing(n);for(var h in this._properties)e=this._sv[h],s=this._ev[h],this.target[h]=e+(s-e)*r;if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(!0),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties)tmp=this._sv[i],this._sv[i]=this._ev[i],this._ev[i]=tmp;this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceIn=function(t){return 1-BounceOut(1-t)},BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,s=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=s*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*.5+1)}}}()),function(){var t=pc.Application.getApplication();t&&(t._tweenManager=new pc.TweenManager(t),t.on("update",(function(i){t._tweenManager.update(i)})),pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.on("destroy",(function(){e.stop()})),i&&i.element&&(e.element=element),e})}();var alphaNew,Hotspot=pc.createScript("hotspot");Hotspot.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),Hotspot.attributes.add("radius",{type:"number",title:"Radius"}),Hotspot.attributes.add("ButtonEntity",{type:"entity"}),Hotspot.prototype.initialize=function(){this.hitArea=new pc.BoundingSphere(this.entity.getPosition(),this.radius),this.ray=new pc.Ray,this.defaultForwardDirection=this.entity.forward.clone(),this.directionToCamera=new pc.Vec3,this.sprite=this.entity.children[0],this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this)})),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.on("destroy",(function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this)})));const t=this.ButtonEntity.children[0].element.text.length*this.ButtonEntity.children[0].element.fontSize/2;this.ButtonEntity.element.width=t,this.entity.children[0].model.meshInstances[0].material=this.entity.children[0].model.meshInstances[0].material.clone()},Hotspot.prototype.SubInitialize=function(){this.hitArea=new pc.BoundingSphere(this.entity.getPosition(),this.radius),this.ray=new pc.Ray,this.defaultForwardDirection=this.entity.forward.clone(),this.directionToCamera=new pc.Vec3,this.sprite=this.entity.children[0],this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this)})),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.on("destroy",(function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this)})));const t=this.ButtonEntity.children[0].element.text.length*this.ButtonEntity.children[0].element.fontSize/2;this.ButtonEntity.element.width=t,this.entity.children[0].model.meshInstances[0].material=this.entity.children[0].model.meshInstances[0].material.clone(),this.cameraEntity=this.app.root.findByName("CameraNew")},Hotspot.prototype.update=function(t){var e=this.cameraEntity.getPosition();this.entity.lookAt(e,this.cameraEntity.up)},Hotspot.prototype.onMouseMove=function(t){if(allowHotspot){this.DisableBtn(),from=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.nearClip),to=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip);var e=this.app.systems.rigidbody.raycastFirst(from,to);e&&e.entity.parent.tags.has("HotSpot")&&(this.DisableBtn(),e.entity.model.meshInstances[0].material.opacity=0,e.entity.model.meshInstances[0].material.update(),e.entity.parent.script.hotspot.ButtonEntity.enabled=!0)}},Hotspot.prototype.DisableBtn=function(){const t=this.app.root.findByTag("HotSpot");for(let e=0;e<t.length;e++)t[e].script.hotspot.ButtonEntity.enabled=!1,t[e].children[0].model.meshInstances[0].material.opacity=1,t[e].children[0].model.meshInstances[0].material.update()},Hotspot.prototype.doRayCast=function(t){from=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.nearClip),to=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip);var e=this.app.systems.rigidbody.raycastFirst(from,to);e&&console.log(e.entity.name)},Hotspot.prototype.doRayCastHover=function(t){from=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.nearClip),to=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip);var e=this.app.systems.rigidbody.raycastFirst(from,to);e&&e.entity.parent.tags.has("HotSpot")&&(e.entity.parent.script.hotspot.ButtonEntity.enabled||(this.DisableBtn(),console.log("on"),e.entity.model.meshInstances[0].material.opacity=0,e.entity.model.meshInstances[0].material.update(),e.entity.parent.script.hotspot.ButtonEntity.enabled=!0))},Hotspot.prototype.onMouseDown=function(t){t.button==pc.MOUSEBUTTON_LEFT&&allowHotspot&&this.doRayCast(t)},Hotspot.prototype.onTouchStart=function(t){1==t.touches.length&&allowHotspot&&(this.doRayCastHover(t.touches[0]),t.event.preventDefault())};var Pulse=pc.createScript("pulse");Pulse.attributes.add("pulseTimeSecs",{type:"number",default:2,title:"Pulse Time Secs"}),Pulse.prototype.initialize=function(){this.secsSinceStart=this.pulseTimeSecs+1,this.entity.on("pulse:start",this.onStartEvent,this)},Pulse.prototype.update=function(t){},Pulse.prototype.onStartEvent=function(){console.log(this.entity.name+" entity name")};var self,OpacityUi=pc.createScript("opacityUi");OpacityUi.attributes.add("ButtonUI",{type:"entity"}),OpacityUi.attributes.add("TextUI",{type:"entity"}),OpacityUi.attributes.add("materialBtn",{type:"asset"}),OpacityUi.attributes.add("Hotspot",{type:"entity"}),OpacityUi.attributes.add("textValue",{type:"string"}),OpacityUi.attributes.add("HoverEntity",{type:"entity"}),OpacityUi.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),OpacityUi.prototype.initialize=function(){this.hitArea=new pc.BoundingSphere(this.entity.getPosition(),this.radius),this.ray=new pc.Ray,this.defaultForwardDirection=this.entity.forward.clone(),this.Mat=this.materialBtn.resource,this.directionToCamera=new pc.Vec3,this.sprite=this.entity.children[0],this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.childMat=this.entity.children[0].model.meshInstances[0].material;var t=this.textValue.length;console.log(t),this.TextUI.element.text=this.textValue,self=this},OpacityUi.prototype.update=function(t){this.TextUI.element.opacity=alphaNew},OpacityUi.prototype.onMouseDown=function(t){t.button==pc.MOUSEBUTTON_LEFT&&this.doRayCast(t)},OpacityUi.prototype.onTouchStart=function(t){1==t.touches.length&&(this.doRayCast(t.touches[0]),t.event.preventDefault())},OpacityUi.prototype.doRayCast=function(t){var i=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.nearClip),e=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip),a=this.app.systems.rigidbody.raycastFirst(i,e);if(a&&a.entity==this.Hotspot){var s=this.textValue;s=s.replaceAll(" ",""),pc.Application.getApplication().once("postrender",(function(){window.parent&&(window.parent.postMessage("app:"+s,"*"),console.log("app:"+s))}))}};pc.script.createLoadingScreen((function(e){var t,a;t=["body {","    background-color: #283538;","}","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-image: radial-gradient(#102030, #000000 , #101020);","}","#application-splash {","    position: absolute;","    top: calc(50% - 270px);","    width: 540px;","    left: calc(50% - 270px);","}","#application-splash img {","    width: 100%;","}","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 4px;","    width: 100%;","    background-image: linear-gradient(to left,#d0e3db, #f8f9e1 , #eef2c8);","}","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #fff;","}","@media (max-width: 600px) {","    #application-splash {","        width: 270px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="none";document.createElement("img");t.style.display="block";var a=document.createElement("div");a.id="progress-bar-container",t.appendChild(a);var n=document.createElement("div");n.id="progress-bar",a.appendChild(n)}(),e.on("preload:end",(function(){e.off("preload:progress")})),e.on("preload:progress",(function(e){var t=document.getElementById("progress-bar-container");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%")})),e.on("start",(function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)}))}));pc.script.createLoadingScreen((function(e){var RadialProgress=function(e,r,t,s,i,a){this.radialProgress=document.createElement("div"),this.radialProgress.id="splash2",this.style=document.createElement("style"),this.progress=0;var o=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,l=e-(r=r%2==1?r+1:r),n=r/2;this.radialProgress.className="radial-progress",this.radialProgress.innerHTML='<div class="inner-circle"><div class="progress">0%</div></div><div class="outer-circle"><div class="mask full"><div class="fill"></div></div><div class="mask"><div class="fill"></div><div class="fill fix"></div></div></div>',this.style.type="text/css",this.style.innerHTML=".radial-progress {width:"+e+"px;height: "+e+"px;position: absolute;margin: auto;top: 0; right: 0; bottom: 0; left: 0;z-index: "+a+";background-color: #DDD;border-radius: 50%;box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.2);}.radial-progress .inner-circle {width: "+l+"px;height: "+l+"px;position: absolute;margin-top: "+n+"px;margin-left: "+n+"px;background-color: "+s+";border-radius: 50%;z-index: 10;}.radial-progress .inner-circle .progress {height: 1em;position: absolute;margin: auto;top: 0; right: 0; bottom: 0; left: 0;text-align: center;color: "+i+";}.radial-progress .outer-circle .mask,.radial-progress .outer-circle .fill {width: "+e+"px;height: "+e+"px;position: absolute;border-radius: 50%;-webkit-backface-visibility: hidden;}.radial-progress .outer-circle .mask {clip: rect(0px, "+e+"px, "+e+"px, "+e/2+"px);}.radial-progress .outer-circle .mask .fill {clip: rect(0px, "+e/2+"px, "+e+"px, 0px);background-color: "+t+";}",document.getElementsByTagName("head")[0].appendChild(this.style),document.body.appendChild(this.radialProgress),this.remove=function(){var e=this,r=1,t=.01;o((function step(){r=(r+=t)<0?0:r,e.radialProgress.style.transform="scale("+r+")",r>1.1&&(t=-1.1/8),r>0?o(step):(document.getElementsByTagName("head")[0].removeChild(e.style),e.radialProgress)}))},this.setProgress4=function(e,r){e=e>100?100:e;var t=this,s=this.radialProgress.getElementsByClassName("mask full")[0],i=this.radialProgress.getElementsByClassName("fill"),a=this.radialProgress.getElementsByClassName("fill fix")[0],l=this.radialProgress.getElementsByClassName("progress")[0],n=(e-this.progress)/(60*r);o((function step(){t.progress+=n,t.progress=t.progress>e?e:t.progress;var r=1.8*t.progress;s.style.transform="rotate("+r+"deg)",l.innerHTML=t.progress.toFixed()+"%";for(var d=0;d<i.length;++d)i[d].style.transform="rotate("+r+"deg)";a.style.transform="rotate("+2*r+"deg)",t.progress<e&&o(step),100===t.progress&&setTimeout((function(){t.remove()}),1e3)}))}},r=new RadialProgress(150,3,"#0095DD","#FFF","#000",10);var t,s;t=["body {","    background-color: #fff;","}","","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #fff;","}","","#application-splash {","    position: absolute;","    top: calc(34.5% - 28px);","    width: 264px;","    left: calc(52% - 122px);","}","","#application-splash img {","    width: 80%;","}","","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 2px;","    width: 100%;","    background-color: #1d292c;","}","","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #f60;","}","","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(52% - 85px);","    }","}"].join("\n"),(s=document.createElement("style")).type="text/css",s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t)),document.head.appendChild(s),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var r=document.createElement("div");r.id="application-splash",e.appendChild(r),r.style.display="none";var t=document.createElement("img");t.src="https://i.ibb.co/grmCyr8/loadingbar-red.png",r.appendChild(t),t.onload=function(){r.style.display="block"};var s=document.createElement("div");s.id="progress-bar-container",s.style.display="none",r.appendChild(s);var i=document.createElement("div");i.id="progress-bar",i.style.display="none",s.appendChild(i)}(),e.on("preload:end",(function(){e.off("preload:progress")})),e.on("preload:progress",(function(e){var t=document.getElementById("progress-bar");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%",r.setProgress4(parseInt(100*e),.5))})),e.on("start",(function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e);var r=document.getElementById("splash2");r.parentElement&&r.parentElement.removeChild(r)}))}));var ButtonLogic=pc.createScript("buttonLogic");ButtonLogic.attributes.add("textEntity",{type:"entity",description:"The entity that we want to update when the button is clicked"}),ButtonLogic.attributes.add("description",{type:"string"}),ButtonLogic.prototype.initialize=function(){this.entity.button.on("click",(function(t){this.app.fire("ui:SetFocus",this.entity.parent.parent.parent.name,this.entity.parent.parent.parent.getPosition())}),this)};var MainScene=pc.createScript("mainScene");MainScene.attributes.add("mainScene",{type:"string",default:"0",title:"Scene ID to Load"}),MainScene.prototype.initialize=function(){var e=this;this.entity.element.on("click",(function(n){setTimeout(function(){var n=e.app.scenes.find("Scene2");e.app.scenes.unloadSceneData(n),e.loadScene(this.mainScene)}.bind(e),10)}),this)},MainScene.prototype.loadScene=function(e){var n=this.app.scenes.find("MainScene");this.app.scenes.loadSceneHierarchy(n,(function(e,n){e||(console.log("scene loaded"),allowHotspot=!0)}))};var ChangingScenes=pc.createScript("changingScenes");ChangingScenes.attributes.add("sceneName",{type:"string",default:"",title:"Scene Name to Load"}),ChangingScenes.prototype.initialize=function(e){var n=this;this.entity.element.on("click",(function(e){setTimeout(function(){n.loadScene(n.sceneName)}.bind(n),10)}),this),this.scene=this.app.scenes.find(this.sceneName),this.app.scenes.loadSceneData(this.scene,(function(e,n){e&&console.error(e)}))},ChangingScenes.prototype.loadScene=function(e){var n=this.app.root.findByName("Root"),t=this;t.app.scenes.loadSceneHierarchy(t.scene,(function(e,o){e?console.error(e):t.app.scenes.loadSceneSettings(t.scene,(function(e,o){e?console.error(e):(n.destroy(),allowHotspot=!0,setTimeout(function(){var e=t.app.root.findByTag("HotSpot");for(let n=0;n<e.length;n++)e[n].script.hotspot.SubInitialize();console.log("timeout")}.bind(t),100),console.log("loaded"))}))}))};var CustomInput=pc.createScript("customInput");CustomInput.attributes.add("BoundingBox",{type:"entity"}),CustomInput.prototype.initialize=function(){this.panOnly=!0,this.orBitOnly=!1},CustomInput.prototype.update=function(t){};var ButtonRotate=pc.createScript("buttonRotate");ButtonRotate.prototype.initialize=function(){this.entity.button.on("hoverstart",this.hoverStart,this),this.rotating=!1},ButtonRotate.prototype.update=function(t){},ButtonRotate.prototype.hoverStart=function(){if(!this.rotating){let i=this.entity.children[0].getEulerAngles().clone(),o=new pc.Vec3(i.x,i.y,i.z-90);var t=this;this.easing="Linear",this.delay=0,this.duration=.5,this.loop=!1,this.yoyo=!1,this.tween=this.entity.children[0].tween(i).rotate(o,this.duration,pc[this.easing]).delay(this.delay).loop(this.loop).yoyo(this.yoyo),this.tween.start(),this.rotating=!0,setTimeout((function(){t.rotating=!1}),550)}};var ButtonInput=pc.createScript("buttonInput");ButtonInput.attributes.add("BuildingPos",{type:"entity"}),ButtonInput.prototype.initialize=function(){this.entity.button.on("click",(function(t){this.app.fire("ui:SetFocus",this.entity.name,this.BuildingPos.getPosition())}),this)},ButtonInput.prototype.update=function(t){};var self,LookCamera=pc.createScript("lookCamera");LookCamera.attributes.add("mouseLookSensitivity",{type:"number",default:0,title:"Mouse Look Sensitivity"}),LookCamera.attributes.add("touchLookSensitivity",{type:"number",default:0,title:"Touch Look Sensitivity"}),LookCamera.attributes.add("pinchSensitivity",{type:"number",default:0,title:"Pinch Sensitivity"}),LookCamera.attributes.add("snappinessFactor",{type:"number",default:.1,title:"Snappiness Factor",description:"Lower is faster"}),LookCamera.prototype.initialize=function(){this._tempQuat1=new pc.Quat,this._tempQuat2=new pc.Quat,this._tempVec3_1=new pc.Vec3,self=this,this.lastPinchDistance=0,this.lastTouchPoint=new pc.Vec2,this.orbitCamera=this.entity.script.orbitCamera,console.log(this.orbitCamera);var t=this.entity.getLocalRotation();this.ey=this.getYaw(t)*pc.math.RAD_TO_DEG,this.ex=this.getPitch(t,this.ey)*pc.math.RAD_TO_DEG,this.targetEx=this.ex,this.targetEy=this.ey,this.moved=!1,this.app.mouse.disableContextMenu(),this.lastTouchPosition=new pc.Vec2,this.addEventCallbacks(),this.on("destroy",(function(){this.removeEventCallbacks()}),this)},LookCamera.prototype.addEventCallbacks=function(){this.app.mouse&&(this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)),this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStart,this))},LookCamera.prototype.removeEventCallbacks=function(){this.app.mouse&&(this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this)),this.app.touch&&(this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStart,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStart,this))},LookCamera.prototype.update=function(t){var o=1;this.snappinessFactor>0&&(o=t/this.snappinessFactor),this.ex=pc.math.lerp(this.ex,this.targetEx,o),this.ey=pc.math.lerp(this.ey,this.targetEy,o),this.entity.setLocalEulerAngles(this.ex,this.ey,0)},LookCamera.prototype.onMouseWheel=function(t){let o=this.entity.camera.fov,i=pc.math.clamp(o-t.wheel,0,90);this.entity.camera.fov=i},LookCamera.prototype.moveCamera=function(t,o,i){this.moved?(this.targetEx+=o*i,this.targetEx=pc.math.clamp(this.targetEx,-90,90),this.targetEy+=t*i):this.moved=!0},LookCamera.prototype.onMouseMove=function(t){this.app.mouse.isPressed(pc.MOUSEBUTTON_LEFT)&&this.moveCamera(t.dx,t.dy,this.mouseLookSensitivity)},LookCamera.prototype.onTouchStart=function(t){var o=t.touches;1==o.length?this.lastTouchPosition.set(o[0].x,o[0].y):2==o.length&&(this.lastPinchDistance=this.getPinchDistance(o[0],o[1]),this.calcMidPoint(o[0],o[1],this.lastPinchMidPoint))},LookCamera.prototype.getPinchDistance=function(t,o){var i=t.x-o.x,e=t.y-o.y;return Math.sqrt(i*i+e*e)},LookCamera.prototype.calcMidPoint=function(t,o,i){i.set(o.x-t.x,o.y-t.y),i.scale(.5),i.x+=t.x,i.y+=t.y},LookCamera.pinchMidPoint=new pc.Vec2,LookCamera.prototype.onTouchMove=function(t){var o=LookCamera.pinchMidPoint;if(1==t.touches.length){var i=t.touches[0];this.moveCamera(i.x-this.lastTouchPosition.x,i.y-this.lastTouchPosition.y,this.touchLookSensitivity),this.lastTouchPosition.set(i.x,i.y)}if(2==t.touches.length){var e=this.getPinchDistance(t.touches[0],t.touches[1]),s=e-this.lastPinchDistance;this.lastPinchDistance=e;let i=this.entity.camera.fov,a=pc.math.clamp(i-s*this.pinchSensitivity,0,90);this.entity.camera.fov=a,this.calcMidPoint(t.touches[0],t.touches[1],o)}},LookCamera.prototype.getYaw=function(){var t=this.entity.forward.clone();return Math.atan2(-t.x,-t.z)},LookCamera.prototype.getPitch=function(t,o){var i=this._tempQuat1,e=this._tempQuat2;e.setFromEulerAngles(0,-o,0),i.mul2(e,t);var s=this._tempVec3_1;return i.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)};var LookOrbitCamera=pc.createScript("lookOrbitCamera");LookOrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),LookOrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),LookOrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),LookOrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),LookOrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),LookOrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),LookOrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(LookOrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(LookOrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(LookOrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(LookOrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),LookOrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},LookOrbitCamera.distanceBetween=new pc.Vec3,LookOrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=LookOrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition(),this.autoRender||(this.app.renderNextFrame=!0)},LookOrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},LookOrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia(),this.autoRender||(this.app.renderNextFrame=!0)},LookOrbitCamera.prototype.initialize=function(){this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var t=this.entity.getRotation();if(this._yaw=this._calcYaw(t),this._pitch=this._clampPitchAngle(this._calcPitch(t,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var i=new pc.Vec3;i.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(i.length())}this._targetDistance=this._distance,this._autoRenderDefault=this.app.autoRender,this.app.autoRender&&(this.app.autoRender=this.autoRender),this.autoRender||(this.app.renderNextFrame=!0),this.on("attr:autoRender",(function(t,i){this.app.autoRender=t,this.autoRender||(this.app.renderNextFrame=!0)}),this),this.on("attr:distanceMin",(function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this),this.on("attr:distanceMax",(function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this),this.on("attr:pitchAngleMin",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this),this.on("attr:pitchAngleMax",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this),this.on("attr:focusEntity",(function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)}),this),this.on("attr:frameOnStart",(function(t,i){t&&this.focus(this.focusEntity||this.app.root)}),this);var onResizeCanvas=function(){this._checkAspectRatio(),this.autoRender||(this.app.renderNextFrame=!0)};this.app.graphicsDevice.on("resizecanvas",onResizeCanvas,this),this.on("destroy",(function(){this.app.graphicsDevice.off("resizecanvas",onResizeCanvas,this),this.app.autoRender=this._defaultAutoRender}),this)},LookOrbitCamera.prototype.update=function(t){if(!this.autoRender){var i=Math.abs(this._targetDistance-this._distance),e=Math.abs(this._targetYaw-this._yaw),a=Math.abs(this._targetPitch-this._pitch);this.app.renderNextFrame=this.app.renderNextFrame||i>.01||e>.01||a>.01}var s=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,s),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,s),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,s),this._updatePosition()},LookOrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},LookOrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},LookOrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},LookOrbitCamera.prototype._buildAabb=function(t,i){var e,a=0,s=0;if(t instanceof pc.Entity){var n=[],o=t.findComponents("render");for(a=0;a<o.length;++a)for(e=o[a].meshInstances,s=0;s<e.length;s++)n.push(e[s]);var r=t.findComponents("model");for(a=0;a<r.length;++a)for(e=r[a].meshInstances,s=0;s<e.length;s++)n.push(e[s]);for(a=0;a<n.length;a++)0===i?this._modelsAabb.copy(n[a].aabb):this._modelsAabb.add(n[a].aabb),i+=1}for(a=0;a<t.children.length;++a)i+=this._buildAabb(t.children[a],i);return i},LookOrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},LookOrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},LookOrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},LookOrbitCamera.quatWithoutYaw=new pc.Quat,LookOrbitCamera.yawOffset=new pc.Quat,LookOrbitCamera.prototype._calcPitch=function(t,i){var e=LookOrbitCamera.quatWithoutYaw,a=LookOrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};